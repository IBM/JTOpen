/*
 * QCSQLResultSetFormPanel.java
 *
 * Created on July 21, 2000, 2:33 PM
 *
 * This is free open source software distributed under the IBM Public License found
 * on the World Wide Web at http://oss.software.ibm.com/developerworks/opensource/license10.html
 * Copyright *C* 2000, Jack J. Woehr, PO Box 51, Golden, CO 80402-0051 USA jax@well.com
 * Copyright *C* 2000, International Business Machines Corporation and others. All Rights Reserved.
 */

package com.SoftWoehr.JTOpenContrib.QCDemo;

/** Shows result sets from the QCSQLQueryBuilderPanel
 * @author jax
 * @version 1.0
 */
public class QCSQLResultSetFormPanel extends javax.swing.JPanel {

  private com.ibm.as400.vaccess.ErrorDialogAdapter errorDialogAdapter;

  /** Creates new form QCSQLResultSetFormPanel */
  public QCSQLResultSetFormPanel() {
    initComponents ();
  }

  /** This method is called from within the constructor to
   * initialize the form.
   * WARNING: Do NOT modify this code. The content of this method is
   * always regenerated by the FormEditor.
   */
  private void initComponents () {//GEN-BEGIN:initComponents
    sQLResultSetFormPane1 = new com.ibm.as400.vaccess.SQLResultSetFormPane ();
    jLabel1 = new javax.swing.JLabel ();
    setLayout (new java.awt.BorderLayout ());



    add (sQLResultSetFormPane1, java.awt.BorderLayout.CENTER);

    jLabel1.setText ("Results of a query in the SQL Query Builder which are only valid if that connection is still active.");
    jLabel1.setHorizontalAlignment (javax.swing.SwingConstants.CENTER);


    add (jLabel1, java.awt.BorderLayout.NORTH);

  }//GEN-END:initComponents


  // Variables declaration - do not modify//GEN-BEGIN:variables
  private com.ibm.as400.vaccess.SQLResultSetFormPane sQLResultSetFormPane1;
  private javax.swing.JLabel jLabel1;
  // End of variables declaration//GEN-END:variables

  /** Runs the query passed to this instance by the QCSQLQueryBuilder.
   * @param connection A valid SQLConnection
   * @param query A valid SQLQuery
   */
  public void doQuery(com.ibm.as400.vaccess.SQLConnection connection,String query) {
    try {
      sQLResultSetFormPane1.setConnection(connection);
      sQLResultSetFormPane1.setQuery(query);
      sQLResultSetFormPane1.load();
    }
    catch (java.beans.PropertyVetoException e) {
      e.printStackTrace(System.err);
    }
  }

  /** Connects the ErrorDialogAdapter with any as400.vaccess components present.
   * @param eda An instance of an ErrorDialogAdapter already associated
   * with a suitable Frame.
   */
  public void propagateEDA(com.ibm.as400.vaccess.ErrorDialogAdapter eda) {
    errorDialogAdapter=eda;
    sQLResultSetFormPane1.addErrorListener(eda);
  }
}
